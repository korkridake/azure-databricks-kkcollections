<!DOCTYPE html>
<html><head>
  <meta name="databricks-html-version" content="1">
<title>Dataset - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="Dataset%20-%20Databricks_files/css.css">

<link rel="stylesheet" type="text/css" href="Dataset%20-%20Databricks_files/bootstrap.css">
<link rel="stylesheet" type="text/css" href="Dataset%20-%20Databricks_files/jquery-ui.css">
<link rel="stylesheet" type="text/css" href="Dataset%20-%20Databricks_files/main.css">
<link rel="stylesheet" href="Dataset%20-%20Databricks_files/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico">
<script>window.settings = {"enableSshKeyUI":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","workspaceFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/databricks_guide/index.html","displayName":"Databricks Guide","icon":"question"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/sample_applications/index.html","displayName":"Application Examples","icon":"code"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/courses/index.html","displayName":"Training","icon":"graduation-cap"}],"enableClearStateFeature":false,"dbcForumURL":"http://forums.databricks.com/","maxCustomTags":45,"enableInstanceProfilesUIInJobs":false,"nodeInfo":{"node_types":[{"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"memory_mb":6144,"category":"Community Edition","num_cores":0.88,"support_ebs_volumes":false}],"default_node_type_id":"dev-tier-node"},"enableThirdPartyApplicationsUI":false,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"enableTableHandler":true,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":false,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"clusters":true,"allowRunOnPendingClusters":true,"applications":false,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":false,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"sparkVersions":[{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-603ee96315e2763ac658f02088fa637d69d69ac26d76ce791f1f65cd91bd53cd","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":true},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-10257b76b554bf22b7de2a0f67afe519b744d857b68ac8d74b9ef1b6e1fbedc6","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-8c3d33f199454d80c281382c3570e573f07b23efff3a3c3e83397bb1863218ed","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-efd93e665ef65c872361afb705f21d03af37880940ddadf59dac3245ec83063d","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-f40841fbebd0e733dfd15b2913bc495542eacb05ba2efa43cd192aed8b307046","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-a312e6077d104638f7c65e5fc6dd82bc2ffc329c7afddcd406dcf249ea388a13","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":true},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":false,"customerVisible":true}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":false,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"class-node":1,"r3.8xlarge":8,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":8,"memory-optimized":1,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"c3.4xlarge":2,"g2.2xlarge":2,"c4.8xlarge":4,"r3.xlarge":1,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":false,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.31","accountsLimit":3,"enableX509Authentication":false,"enableNotebookGitBranching":true,"local":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"disableLegacyDashboards":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"defaultSparkVersion":{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":true,"enableMountAclsConfig":false,"useDevTierHomePage":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableClusterAclsByTier":false,"disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"useFixedStaticNotebookVersionForDevelopment":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableWorkspaceAclService":true,"docsDomain":"https://docs.cloud.databricks.com/","enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"d021cfb95994095f8eba80e12423a5f1461121b6","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableDebugUI":false,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSparkPackages":true,"dynamicSparkVersions":true,"enableNotebookHistoryUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/A%20Gentle%20Introduction%20to%20Apache%20Spark%20on%20Databricks.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/Quick%20Start%20DataFrames.html","displayName":"Quick Start DataFrames","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/GSW%20Passing%20Analysis%20(new).html","displayName":"GSW Passing Analysis (new)","icon":"img/home/Python_icon.svg"}],"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"enableTerminal":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"accounts":true,"useFramedStaticNotebooks":true,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"showSqlProxyUI":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":3010286467588839,"name":"Dataset","language":"scala","commands":[{"version":"CommandV1","origId":3010286467588841,"guid":"4981cab1-ed74-4664-892a-989a827b9408","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n# Dataset API\n\nIn this notebook, we demonstrate the new Dataset API in Spark 2.0, using a very simple JSON file.\n\nTo read the companion blog post, click here: https://databricks.com/blog/2016/05/11/spark-2-0-technical-preview-easier-faster-and-smarter.html","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922040937E12,"submitTime":1.462922040937E12,"finishTime":1.462922040937E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a6fb61b0-5e50-4674-8f3e-e135e9a08669"},{"version":"CommandV1","origId":3010286467588842,"guid":"60b82690-16ce-4ce4-91c4-9b528221370c","subtype":"command","commandType":"auto","position":1.0,"command":"// Take a look at the content of the file\ndbutils.fs.head(\"/home/webinar/person.json\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res39: String = \n&quot;\n{&quot;name&quot;:&quot;Matei Zaharia&quot;,&quot;email&quot;:&quot;matei@databricks.com&quot;,&quot;iq&quot;:180}\n{&quot;name&quot;:&quot;Reynold Xin&quot;,&quot;email&quot;:&quot;rxin@databricks.com&quot;,&quot;iq&quot;:80}\n&quot;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922051964E12,"submitTime":1.462922040937E12,"finishTime":1.462922052219E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"17c6caf7-4cf8-4bdb-9b68-b043d0562798"},{"version":"CommandV1","origId":3010286467588843,"guid":"6e476f28-161b-4ef0-94db-0d65b09330a4","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n### Creating DataFrames and Datasets\n\nStarting Spark 2.0, a DataFrame is simply a type alias for Dataset of Row. There are many ways to create DataFrames and Datasets.\n\nThe first way, used primarily in testing and demos, uses the range function available on SparkSession.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922040941E12,"submitTime":1.462922040941E12,"finishTime":1.462922040944E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a7189f39-ed90-4a11-bcc3-cafa15ffdb6f"},{"version":"CommandV1","origId":3010286467588844,"guid":"9d588d23-9eab-486c-bdae-86222b615b9c","subtype":"command","commandType":"auto","position":2.5,"command":"// range(100) creates a Dataset with 100 elements, from 0 to 99.\nval range100 = spark.range(100)\nrange100.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">range100: org.apache.spark.sql.Dataset[Long] = [id: bigint]\nres40: Array[Long] = Array(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922052223E12,"submitTime":1.462922040945E12,"finishTime":1.462922052476E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9c7287dc-0677-402f-a375-e3e9481ff418"},{"version":"CommandV1","origId":3010286467588845,"guid":"7cc50495-d878-4bcc-961a-ab83a02f3252","subtype":"command","commandType":"auto","position":2.75,"command":"%md\nThe second way, which is probably the most common way, is to create a DataFrame/Dataset by referencing some files on external storage systems.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922040948E12,"submitTime":1.462922040948E12,"finishTime":1.462922040951E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ea12b757-057a-4aa2-a919-acdb14a37e51"},{"version":"CommandV1","origId":3010286467588846,"guid":"206ab030-3b2f-4132-adce-e177ed9e1325","subtype":"command","commandType":"auto","position":3.0,"command":"// Read the data in as a DataFrame\nval jsonData = spark.read.json(\"/home/webinar/person.json\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">jsonData: org.apache.spark.sql.DataFrame = [email: string, iq: bigint ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922052481E12,"submitTime":1.462922040952E12,"finishTime":1.462922052874E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a2be5029-56b9-4ce6-a07b-87bf5655ee97"},{"version":"CommandV1","origId":3010286467588847,"guid":"ef4c0740-b66f-409c-8775-c9a474968cf0","subtype":"command","commandType":"auto","position":3.0625,"command":"display(jsonData)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["matei@databricks.com",180.0,"Matei Zaharia"],["rxin@databricks.com",80.0,"Reynold Xin"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"email","type":"\"string\""},{"name":"iq","type":"\"long\""},{"name":"name","type":"\"string\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922052878E12,"submitTime":1.462922040955E12,"finishTime":1.462922053098E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7fe61c2e-a709-42c1-b65a-193d2d254040"},{"version":"CommandV1","origId":3010286467588848,"guid":"1b8aafa3-4d29-4099-add0-06225b2d17f4","subtype":"command","commandType":"auto","position":3.1875,"command":"// DataFrame is just an alias for Dataset[Row]\nimport org.apache.spark.sql.Dataset\nval jsonDataset: Dataset[Row] = jsonData","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.Dataset\njsonDataset: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [email: string, iq: bigint ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:35: error: not found: type Dataset\n       val jsonDataset: Dataset[Row] = jsonData\n                        ^\n</div>","error":null,"workflows":[],"startTime":1.462922053102E12,"submitTime":1.462922040959E12,"finishTime":1.462922053197E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"07711943-1ddf-452f-ab0b-1fbb7866a30e"},{"version":"CommandV1","origId":3010286467588849,"guid":"b94125a6-5ef9-4c01-9ffc-3fb3e89420db","subtype":"command","commandType":"auto","position":3.265625,"command":"%md\nDatabricks' display works on both DataFrames and Datasets.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922040962E12,"submitTime":1.462922040962E12,"finishTime":1.462922040965E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"da021722-3de6-4932-a779-37a5499fdd5a"},{"version":"CommandV1","origId":3010286467588850,"guid":"e9da01f1-c159-491c-b206-ee2ac39ddb75","subtype":"command","commandType":"auto","position":3.3046875,"command":"display(jsonDataset)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["matei@databricks.com",180.0,"Matei Zaharia"],["rxin@databricks.com",80.0,"Reynold Xin"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"email","type":"\"string\""},{"name":"iq","type":"\"long\""},{"name":"name","type":"\"string\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922053201E12,"submitTime":1.462922040965E12,"finishTime":1.462922053433E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"387e854f-c751-440a-a572-be02e7c539f4"},{"version":"CommandV1","origId":3010286467588851,"guid":"f9833e9a-debc-4828-a6f3-dd9988f90903","subtype":"command","commandType":"auto","position":3.34375,"command":"%md\nDataFrame (or Dataset of Row) is great, but sometimes I want compile-time type safety and we would to be able to work with my own domain-specific objects. Here we demonstrate how to turn an untyped Dataset into a typed Dataset.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922040969E12,"submitTime":1.462922040969E12,"finishTime":1.462922040973E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3aed9ff8-c2f3-494f-93c1-32fffe33466b"},{"version":"CommandV1","origId":3010286467588852,"guid":"5a83231f-378b-44e1-9719-f97d0089526e","subtype":"command","commandType":"auto","position":3.5,"command":"// First, define my domain specific class\ncase class Person(email: String, iq: Long, name: String)\n\n// Turn a generic DataFrame into a Dataset of Person\nval ds = spark.read.json(\"/home/webinar/person.json\").as[Person]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class Person\nds: org.apache.spark.sql.Dataset[Person] = [email: string, iq: bigint ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922053437E12,"submitTime":1.462922040973E12,"finishTime":1.462922053936E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"210d23ab-b16b-4cf3-a75d-b1016ec8e0a9"},{"version":"CommandV1","origId":3010286467588853,"guid":"739fa3d6-a519-4e91-80f7-44971b231215","subtype":"command","commandType":"auto","position":3.875,"command":"%md\n### Metadata operations\n\nThere are a few metadata operations that are very handy for Datasets.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922040977E12,"submitTime":1.462922040977E12,"finishTime":1.462922040979E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5c467de0-630e-466d-b5bf-a0b1b0dfc8a6"},{"version":"CommandV1","origId":3010286467588854,"guid":"be855d71-5cda-4602-b933-1f343f32e19f","subtype":"command","commandType":"auto","position":3.96875,"command":"// Get the list of columns\nds.columns","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res43: Array[String] = Array(email, iq, name)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.46292205394E12,"submitTime":1.46292204098E12,"finishTime":1.462922054052E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7f99b6d0-059b-429d-a064-18fbada790b8"},{"version":"CommandV1","origId":3010286467588855,"guid":"80e2042b-3dce-4454-bb63-68560b0256fd","subtype":"command","commandType":"auto","position":4.0625,"command":"// Get the schema of the underlying data structure.\nds.schema","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res44: org.apache.spark.sql.types.StructType = StructType(StructField(email,StringType,true), StructField(iq,LongType,true), StructField(name,StringType,true))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922054057E12,"submitTime":1.462922040983E12,"finishTime":1.462922054166E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a583919c-b4a4-41ac-9423-f332ca319828"},{"version":"CommandV1","origId":3010286467588856,"guid":"608ad138-544e-4c30-b6f6-e517b02aa1e0","subtype":"command","commandType":"auto","position":4.15625,"command":"// Explain the logical and physical query plan to compute the Dataset.\nds.explain(true)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Parsed Logical Plan ==\nRelation[email#2250,iq#2251L,name#2252] HadoopFiles\n\n== Analyzed Logical Plan ==\nemail: string, iq: bigint, name: string\nRelation[email#2250,iq#2251L,name#2252] HadoopFiles\n\n== Optimized Logical Plan ==\nRelation[email#2250,iq#2251L,name#2252] HadoopFiles\n\n== Physical Plan ==\nWholeStageCodegen\n:  +- Scan HadoopFiles[email#2250,iq#2251L,name#2252] Format: JSON, PushedFilters: [], ReadSchema: struct&lt;email:string,iq:bigint,name:string&gt;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922054169E12,"submitTime":1.462922040986E12,"finishTime":1.462922054289E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ad9bb3dc-d648-4d40-9aff-2ea85cc59c42"},{"version":"CommandV1","origId":3010286467588857,"guid":"e186617f-aacc-4e3f-80b0-ca33425a85fc","subtype":"command","commandType":"auto","position":4.25,"command":"%md\n### Typed Dataset API\n\nDataset includes a typed functional API similar to RDDs and Scala's own collection library. This API is available in Scala/Java, but not Python/R.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922040989E12,"submitTime":1.462922040989E12,"finishTime":1.462922040992E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8908bcd9-323f-48fb-aa91-5dd27caca8c1"},{"version":"CommandV1","origId":3010286467588858,"guid":"1c50aff4-277e-4e5b-a9ae-628f91f0f19b","subtype":"command","commandType":"auto","position":5.0,"command":"// Run a map\nds.map(_.name).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res46: Array[String] = Array(Matei Zaharia, Reynold Xin)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:41: error: value display is not a member of org.apache.spark.sql.Dataset[String]\n              ds.map(_.name).display()\n                             ^\n</div>","error":null,"workflows":[],"startTime":1.462922054293E12,"submitTime":1.462922040992E12,"finishTime":1.462922054563E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4c0c8cfb-0cc8-442c-8051-bb77f60a01c9"},{"version":"CommandV1","origId":3010286467588859,"guid":"eb8c7b17-34cf-45d5-b404-7dc7f666a271","subtype":"command","commandType":"auto","position":6.0,"command":"// Run a filter\nds.filter(_.iq > 140).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res47: Array[Person] = Array(Person(matei@databricks.com,180,Matei Zaharia))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922054567E12,"submitTime":1.462922040995E12,"finishTime":1.462922054844E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"62018b3f-da8b-4e78-a124-117d52f46cbf"},{"version":"CommandV1","origId":3010286467588860,"guid":"8b4fb3b4-5bd6-4954-9901-91c72cc84bdd","subtype":"command","commandType":"auto","position":7.0,"command":"// Can also run agregations to compute total IQ and average IQ grouped by some key\n// In this case we are just grouping by a constant 0, i.e. all records get grouped together\nimport org.apache.spark.sql.expressions.scala.typed\nds.groupByKey(_ => 0).agg(typed.sum(_.iq), typed.avg(_.iq)).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.expressions.scala.typed\nres48: Array[(Int, Double, Double)] = Array((0,260.0,130.0))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922054848E12,"submitTime":1.462922040998E12,"finishTime":1.462922055734E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"44447591-b046-44af-bdc1-4668e7fe4273"},{"version":"CommandV1","origId":3010286467588861,"guid":"687eb7cc-e393-4c0d-89c0-6256624ffe58","subtype":"command","commandType":"auto","position":9.0,"command":"%md\n### Untyped Dataset API (a.k.a. DataFrame API)\n\nDataset also includes untyped functions that return results in the form of DataFrames (i.e. Dataset[Row]). This API is available in all programming languages (Java/Scala/Python/R).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922041001E12,"submitTime":1.462922041001E12,"finishTime":1.462922041003E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1d0e3f25-342a-41ae-b56f-77ea77ab10d7"},{"version":"CommandV1","origId":3010286467588862,"guid":"f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9","subtype":"command","commandType":"auto","position":10.0,"command":"// The select function is similar to the map function, but is not typed (i.e. it returns a DataFrame)\nds.select(\"name\").collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res49: Array[org.apache.spark.sql.Row] = Array([Matei Zaharia], [Reynold Xin])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922055737E12,"submitTime":1.462922041004E12,"finishTime":1.462922055927E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5f865ddb-737e-4295-8b6e-54a6172b485f"},{"version":"CommandV1","origId":3010286467588863,"guid":"15c1ac54-fda8-4aad-933f-3714de34214f","subtype":"command","commandType":"auto","position":11.0,"command":"// Run some aggregations: note that we are using groupBy, which is different from the type safe groupByKey\nimport org.apache.spark.sql.functions.{sum, avg}\nds.groupBy().agg(sum(\"iq\"), avg(\"iq\")).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.{sum, avg}\nres50: Array[org.apache.spark.sql.Row] = Array([260,130.0])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:58: error: type mismatch;\n found   : String(&quot;iq&quot;)\n required: ? =&gt; Double\n              ds.groupBy().agg(sum(&quot;iq&quot;), avg(&quot;iq&quot;))\n                                   ^\n</div>","error":null,"workflows":[],"startTime":1.46292205593E12,"submitTime":1.462922041006E12,"finishTime":1.46292205621E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0e3b1596-43c5-4d09-ac76-c0a4a33621b0"},{"version":"CommandV1","origId":3010286467588864,"guid":"e456d13f-ce72-44ff-94d3-1d76488aa5b7","subtype":"command","commandType":"auto","position":12.0,"command":"%md\n### Interoperate with RDDs\n\nA Dataset can be easily turned into an RDD.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922041009E12,"submitTime":1.462922041009E12,"finishTime":1.462922041011E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"94d289a4-b73d-48c5-9587-68667120d3ec"},{"version":"CommandV1","origId":3010286467588865,"guid":"af643d8d-cfd2-4df7-a638-f7884c22851f","subtype":"command","commandType":"auto","position":13.0,"command":"ds.rdd","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res51: org.apache.spark.rdd.RDD[Person] = MapPartitionsRDD[679] at rdd at &lt;console&gt;:65\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.462922056214E12,"submitTime":1.462922041012E12,"finishTime":1.462922056332E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a676fa8a-33b0-4772-9b6b-7041af806567"},{"version":"CommandV1","origId":3010286467588866,"guid":"d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6","subtype":"command","commandType":"auto","position":15.0,"command":"%md\nAgain, to read the companion blog post, click here: https://databricks.com/blog/2016/05/11/spark-2-0-technical-preview-easier-faster-and-smarter.html","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":1.462922041014E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b4d6dd8d-842a-4572-af5b-acb094ac3e92"}],"dashboards":[],"guid":"bb38b74a-0160-43ee-978e-0e7d7da17afa","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script src="Dataset%20-%20Databricks_files/notebook-main.js" onerror="window.mainJsLoadError = true;"></script>
</head>
<body><div id="static-notebook" data-reactid=".0"><div id="tooltip" class="hidden" data-reactid=".0.0"><p data-reactid=".0.0.0"><span id="value" data-reactid=".0.0.0.0"></span></p></div><div id="topbar" class="" data-reactid=".0.1"><div class="tb-logo" data-reactid=".0.1.0"><a href="http://databricks.com/" target="_blank" rel="noopener noreferrer" title="Databricks" data-reactid=".0.1.0.0"><img src="Dataset%20-%20Databricks_files/databricks_logoTM_rgb_TM.svg" alt="databricks-logo" data-reactid=".0.1.0.0.0"></a></div><div class="tb-title-wrapper tb-title-wrapper-central" data-reactid=".0.1.1"><span data-reactid=".0.1.1.0"><span class="tb-title" data-reactid=".0.1.1.0.0">Dataset</span><span class="tb-title-lang" data-reactid=".0.1.1.0.1">(Scala)</span></span></div><div class="tb-import" data-reactid=".0.1.2"><a class="btn btn-default import-button" title="Import Notebook" data-reactid=".0.1.2.0"><i class="fa fa-cloud-upload" data-reactid=".0.1.2.0.0"></i><span data-reactid=".0.1.2.0.1"> Import Notebook</span></a></div></div><div id="overallView" class="" data-reactid=".0.2"><div id="content" data-reactid=".0.2.0"><div class="overallContainer" data-reactid=".0.2.0.0"><div class="shell-top new-notebook no-edit no-run static-notebook" data-reactid=".0.2.0.0.0"><img class="load-spinner" src="Dataset%20-%20Databricks_files/spinner.svg" data-reactid=".0.2.0.0.0.0"><div class="command divider" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-0 cell-3010286467588839-3010286467588841" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.4.0.0.0">%md
<span class="cm-header cm-header-1"># </span><span class="cm-header cm-header-1">Dataset</span><span class="cm-header cm-header-1"> </span><span class="cm-header cm-header-1">API</span>

In this notebook, we demonstrate the new Dataset API in Spark 2.0, using a very simple JSON file.

To read the companion blog post, click here: https://databricks.com/blog/2016/05/11/spark-2-0-technical-preview-easier-faster-and-smarter.html
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.5.0.0"><div class="results dashboard" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.5.0.0.4"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="ef0a605d-2f4c-46c5-8155-9d7eb034fb3d"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h1>Dataset API</h1>
<p>In this notebook, we demonstrate the new Dataset API in Spark 2.0, using a very simple JSON file.</p>
<p>To read the companion blog post, click here: <a href="https://databricks.com/blog/2016/05/11/spark-2-0-technical-preview-easier-faster-and-smarter.html">https://databricks.com/blog/2016/05/11/spark-2-0-technical-preview-easier-faster-and-smarter.html</a></p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.5.0.0.6.2.0">0.00</span><span data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$4981cab1-ed74-4664-892a-989a827b9408.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-1 cell-3010286467588839-3010286467588842" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.4.0.0.0"><span class="cm-comment">// Take a look at the content of the file</span>
<span class="cm-variable">dbutils</span>.<span class="cm-variable">fs</span>.<span class="cm-variable">head</span>(<span class="cm-string">"/home/webinar/person.json"</span>)
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.5.0.0.0"></noscript><div class="results" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.5.0.0.4"><div class="ansiout">res39: String = 
"
{"name":"Matei Zaharia","email":"matei@databricks.com","iq":180}
{"name":"Reynold Xin","email":"rxin@databricks.com","iq":80}
"
</div></div><noscript data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.5.0.0.5"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.5.0.0.6.2.0">0.26</span><span data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$60b82690-16ce-4ce4-91c4-9b528221370c.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-2 cell-3010286467588839-3010286467588843" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.4.0.0.0">%md
<span class="cm-header cm-header-3">### </span><span class="cm-header cm-header-3">Creating</span><span class="cm-header cm-header-3"> </span><span class="cm-header cm-header-3">DataFrames</span><span class="cm-header cm-header-3"> </span><span class="cm-header cm-header-3">and</span><span class="cm-header cm-header-3"> </span><span class="cm-header cm-header-3">Datasets</span>

Starting Spark 2.0, a DataFrame is simply a type alias for Dataset of Row. There are many ways to create DataFrames and Datasets.

The first way, used primarily in testing and demos, uses the range function available on SparkSession.
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.5.0.0"><div class="results dashboard" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.5.0.0.4"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="3f34a604-0e55-4a9b-9358-893fa3a0dabf"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>Creating DataFrames and Datasets</h3>
<p>Starting Spark 2.0, a DataFrame is simply a type alias for Dataset of
 Row. There are many ways to create DataFrames and Datasets.</p>
<p>The first way, used primarily in testing and demos, uses the range function available on SparkSession.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.5.0.0.6.2.0">0.00</span><span data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$6e476f28-161b-4ef0-94db-0d65b09330a4.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-3 cell-3010286467588839-3010286467588844" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.4.0.0.0"><span class="cm-comment">// range(100) creates a Dataset with 100 elements, from 0 to 99.</span>
<span class="cm-keyword">val</span> <span class="cm-def">range100</span> <span class="cm-operator">=</span> <span class="cm-variable">spark</span>.<span class="cm-variable">range</span>(<span class="cm-number">100</span>)
<span class="cm-variable">range100</span>.<span class="cm-variable">collect</span>()
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.5.0.0.0"></noscript><div class="results" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.5.0.0.4"><div class="ansiout">range100: org.apache.spark.sql.Dataset[Long] = [id: bigint]
res40: Array[Long] = Array(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99)
</div></div><noscript data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.5.0.0.5"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.5.0.0.6.2.0">0.25</span><span data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$9d588d23-9eab-486c-bdae-86222b615b9c.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-4 cell-3010286467588839-3010286467588845" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.4.0.0.0">%md
The second way, which is probably the most common way, is to create a DataFrame/Dataset by referencing some files on external storage systems.
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.5.0.0"><div class="results dashboard" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.5.0.0.4"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="ee596181-e8e5-425b-8a96-4b50cdce30af"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>The
 second way, which is probably the most common way, is to create a 
DataFrame/Dataset by referencing some files on external storage systems.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.5.0.0.6.2.0">0.00</span><span data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$7cc50495-d878-4bcc-961a-ab83a02f3252.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-5 cell-3010286467588839-3010286467588846" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.4.0.0.0"><span class="cm-comment">// Read the data in as a DataFrame</span>
<span class="cm-keyword">val</span> <span class="cm-def">jsonData</span> <span class="cm-operator">=</span> <span class="cm-variable">spark</span>.<span class="cm-variable">read</span>.<span class="cm-variable">json</span>(<span class="cm-string">"/home/webinar/person.json"</span>)
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.5.0.0.0"></noscript><div class="results" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.5.0.0.4"><div class="ansiout">jsonData: org.apache.spark.sql.DataFrame = [email: string, iq: bigint ... 1 more field]
</div></div><noscript data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.5.0.0.5"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.5.0.0.6.2.0">0.39</span><span data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$206ab030-3b2f-4132-adce-e177ed9e1325.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-6 cell-3010286467588839-3010286467588847" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.4.0.0.0"><span class="cm-variable">display</span>(<span class="cm-variable">jsonData</span>)
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.5.0.0.0"></noscript><div class="results dashboard" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.5.0.0.4"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget ui-resizable" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="a3243539-377e-4a92-94c7-4f1e0f754c2b"><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90; display: block;"></div><div class="widget-content dashboard"><div class="results"><div class="results-table noscroll" tabindex="-1"><div class="floatThead-wrapper" style="position: relative; clear:both;"><div class="inner"><table class="table table-bordered table-condensed table-hover" style="table-layout: fixed; min-width: 1463px;"><colgroup><col style="width: 790.317px;"><col style="width: 179.3px;"><col style="width: 493.783px;"></colgroup><thead><tr class="size-row" style="height: 26px;"><th class="floatThead-col" style="height: 19.2px;"></th><th class="floatThead-col" style="height: 19.2px;"></th><th class="floatThead-col" style="height: 19.2px;"></th></tr></thead><tbody><tr><td>matei@databricks.com</td><td>180</td><td>Matei Zaharia</td></tr><tr><td>rxin@databricks.com</td><td>80</td><td>Reynold Xin</td></tr></tbody></table></div><div style="overflow: hidden; position: absolute; margin-top: 0px; top: 0px; z-index: 1; left: 0px; width: 1463px;" aria-hidden="true" class="floatThead-floatContainer floatThead-container"><table class="table table-bordered table-condensed table-hover floatThead-table" style="margin: 0px; border-bottom-width: 0px; table-layout: fixed; width: 100%;"><colgroup><col style="width: 790.317px;"><col style="width: 179.3px;"><col style="width: 493.783px;"></colgroup><thead><tr><th>email</th><th>iq</th><th>name</th></tr></thead></table></div></div></div></div><!-- downloadControlsTemplate -->
<div class="download-controls">
  
  <a class="btn btn-small results-download-preview" title="Download CSV">
    <i class="fa fa-download"></i>
  </a>
  
</div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><noscript data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.5.0.0.5"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.5.0.0.6.2.0">0.22</span><span data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$ef4c0740-b66f-409c-8775-c9a474968cf0.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-7 cell-3010286467588839-3010286467588848" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.4.0.0.0"><span class="cm-comment">// DataFrame is just an alias for Dataset[Row]</span>
<span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">apache</span>.<span class="cm-variable">spark</span>.<span class="cm-variable">sql</span>.<span class="cm-variable">Dataset</span>
<span class="cm-keyword">val</span> <span class="cm-def">jsonDataset</span>: <span class="cm-variable">Dataset</span>[<span class="cm-variable">Row</span>] <span class="cm-operator">=</span> <span class="cm-variable">jsonData</span>
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.5.0.0.0"></noscript><div class="results" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.5.0.0.4"><div class="ansiout">import org.apache.spark.sql.Dataset
jsonDataset: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [email: string, iq: bigint ... 1 more field]
</div></div><noscript data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.5.0.0.5"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.5.0.0.6.2.0">0.10</span><span data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$1b8aafa3-4d29-4099-add0-06225b2d17f4.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-8 cell-3010286467588839-3010286467588849" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.4.0.0.0">%md
Databricks' display works on both DataFrames and Datasets.
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.5.0.0"><div class="results dashboard" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.5.0.0.4"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="4ced89c6-db1b-4ff4-bd51-d8ab2097b4fb"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>Databricks' display works on both DataFrames and Datasets.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.5.0.0.6.2.0">0.00</span><span data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$b94125a6-5ef9-4c01-9ffc-3fb3e89420db.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-9 cell-3010286467588839-3010286467588850" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.4.0.0.0"><span class="cm-variable">display</span>(<span class="cm-variable">jsonDataset</span>)
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.5.0.0.0"></noscript><div class="results dashboard" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.5.0.0.4"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget ui-resizable" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="40ce414f-3484-4318-8075-b65db80464dc"><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90; display: block;"></div><div class="widget-content dashboard"><div class="results"><div class="results-table noscroll" tabindex="-1"><div class="floatThead-wrapper" style="position: relative; clear:both;"><div class="inner"><table class="table table-bordered table-condensed table-hover" style="table-layout: fixed; min-width: 1463px;"><colgroup><col style="width: 790.317px;"><col style="width: 179.3px;"><col style="width: 493.783px;"></colgroup><thead><tr class="size-row" style="height: 26px;"><th class="floatThead-col" style="height: 19.2px;"></th><th class="floatThead-col" style="height: 19.2px;"></th><th class="floatThead-col" style="height: 19.2px;"></th></tr></thead><tbody><tr><td>matei@databricks.com</td><td>180</td><td>Matei Zaharia</td></tr><tr><td>rxin@databricks.com</td><td>80</td><td>Reynold Xin</td></tr></tbody></table></div><div style="overflow: hidden; position: absolute; margin-top: 0px; top: 0px; z-index: 1; left: 0px; width: 1463px;" aria-hidden="true" class="floatThead-floatContainer floatThead-container"><table class="table table-bordered table-condensed table-hover floatThead-table" style="margin: 0px; border-bottom-width: 0px; table-layout: fixed; width: 100%;"><colgroup><col style="width: 790.317px;"><col style="width: 179.3px;"><col style="width: 493.783px;"></colgroup><thead><tr><th>email</th><th>iq</th><th>name</th></tr></thead></table></div></div></div></div><!-- downloadControlsTemplate -->
<div class="download-controls">
  
  <a class="btn btn-small results-download-preview" title="Download CSV">
    <i class="fa fa-download"></i>
  </a>
  
</div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><noscript data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.5.0.0.5"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.5.0.0.6.2.0">0.23</span><span data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$e9da01f1-c159-491c-b206-ee2ac39ddb75.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-10 cell-3010286467588839-3010286467588851" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.4.0.0.0">%md
DataFrame (or Dataset of Row) is great, but sometimes I want compile-time type safety and we would to be able to work with my own domain-specific objects. Here we demonstrate how to turn an untyped Dataset into a typed Dataset.
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.5.0.0"><div class="results dashboard" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.5.0.0.4"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="d6adb27c-a752-4ba6-b85a-77d70755c070"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>DataFrame
 (or Dataset of Row) is great, but sometimes I want compile-time type 
safety and we would to be able to work with my own domain-specific 
objects. Here we demonstrate how to turn an untyped Dataset into a typed
 Dataset.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.5.0.0.6.2.0">0.00</span><span data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$f9833e9a-debc-4828-a6f3-dd9988f90903.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-11 cell-3010286467588839-3010286467588852" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.4.0.0.0"><span class="cm-comment">// First, define my domain specific class</span>
<span class="cm-keyword">case</span> <span class="cm-keyword">class</span> <span class="cm-def">Person</span>(<span class="cm-variable">email</span>: <span class="cm-type">String</span>, <span class="cm-variable">iq</span>: <span class="cm-type">Long</span>, <span class="cm-variable">name</span>: <span class="cm-type">String</span>)

<span class="cm-comment">// Turn a generic DataFrame into a Dataset of Person</span>
<span class="cm-keyword">val</span> <span class="cm-def">ds</span> <span class="cm-operator">=</span> <span class="cm-variable">spark</span>.<span class="cm-variable">read</span>.<span class="cm-variable">json</span>(<span class="cm-string">"/home/webinar/person.json"</span>).<span class="cm-variable">as</span>[<span class="cm-variable">Person</span>]
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.5.0.0.0"></noscript><div class="results" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.5.0.0.4"><div class="ansiout">defined class Person
ds: org.apache.spark.sql.Dataset[Person] = [email: string, iq: bigint ... 1 more field]
</div></div><noscript data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.5.0.0.5"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.5.0.0.6.2.0">0.50</span><span data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$5a83231f-378b-44e1-9719-f97d0089526e.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-12 cell-3010286467588839-3010286467588853" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.4.0.0.0">%md
<span class="cm-header cm-header-3">### </span><span class="cm-header cm-header-3">Metadata</span><span class="cm-header cm-header-3"> </span><span class="cm-header cm-header-3">operations</span>

There are a few metadata operations that are very handy for Datasets.
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.5.0.0"><div class="results dashboard" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.5.0.0.4"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="093e8e5b-dc32-419d-b092-259d180be07a"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>Metadata operations</h3>
<p>There are a few metadata operations that are very handy for Datasets.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.5.0.0.6.2.0">0.00</span><span data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$739fa3d6-a519-4e91-80f7-44971b231215.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-13 cell-3010286467588839-3010286467588854" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.4.0.0.0"><span class="cm-comment">// Get the list of columns</span>
<span class="cm-variable">ds</span>.<span class="cm-variable">columns</span>
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.5.0.0.0"></noscript><div class="results" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.5.0.0.4"><div class="ansiout">res43: Array[String] = Array(email, iq, name)
</div></div><noscript data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.5.0.0.5"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.5.0.0.6.2.0">0.11</span><span data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$be855d71-5cda-4602-b933-1f343f32e19f.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-14 cell-3010286467588839-3010286467588855" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.4.0.0.0"><span class="cm-comment">// Get the schema of the underlying data structure.</span>
<span class="cm-variable">ds</span>.<span class="cm-variable">schema</span>
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.5.0.0.0"></noscript><div class="results" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.5.0.0.4"><div class="ansiout">res44: org.apache.spark.sql.types.StructType = StructType(StructField(email,StringType,true), StructField(iq,LongType,true), StructField(name,StringType,true))
</div></div><noscript data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.5.0.0.5"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.5.0.0.6.2.0">0.11</span><span data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$80e2042b-3dce-4454-bb63-68560b0256fd.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-15 cell-3010286467588839-3010286467588856" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.4.0.0.0"><span class="cm-comment">// Explain the logical and physical query plan to compute the Dataset.</span>
<span class="cm-variable">ds</span>.<span class="cm-variable">explain</span>(<span class="cm-atom">true</span>)
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.5.0.0.0"></noscript><div class="results" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.5.0.0.4"><div class="ansiout">== Parsed Logical Plan ==
Relation[email#2250,iq#2251L,name#2252] HadoopFiles

== Analyzed Logical Plan ==
email: string, iq: bigint, name: string
Relation[email#2250,iq#2251L,name#2252] HadoopFiles

== Optimized Logical Plan ==
Relation[email#2250,iq#2251L,name#2252] HadoopFiles

== Physical Plan ==
WholeStageCodegen
:  +- Scan HadoopFiles[email#2250,iq#2251L,name#2252] Format: JSON, PushedFilters: [], ReadSchema: struct&lt;email:string,iq:bigint,name:string&gt;
</div></div><noscript data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.5.0.0.5"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.5.0.0.6.2.0">0.12</span><span data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$608ad138-544e-4c30-b6f6-e517b02aa1e0.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-16 cell-3010286467588839-3010286467588857" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.4.0.0.0">%md
<span class="cm-header cm-header-3">### </span><span class="cm-header cm-header-3">Typed</span><span class="cm-header cm-header-3"> </span><span class="cm-header cm-header-3">Dataset</span><span class="cm-header cm-header-3"> </span><span class="cm-header cm-header-3">API</span>

Dataset includes a typed functional API similar to RDDs and Scala's own collection library. This API is available in Scala/Java, but not Python/R.
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.5.0.0"><div class="results dashboard" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.5.0.0.4"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="b82fb65c-6a33-40d3-b071-912f9c436d0a"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>Typed Dataset API</h3>
<p>Dataset includes a typed functional API similar to RDDs and Scala's 
own collection library. This API is available in Scala/Java, but not 
Python/R.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.5.0.0.6.2.0">0.00</span><span data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$e186617f-aacc-4e3f-80b0-ca33425a85fc.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-17 cell-3010286467588839-3010286467588858" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.4.0.0.0"><span class="cm-comment">// Run a map</span>
<span class="cm-variable">ds</span>.<span class="cm-variable">map</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">name</span>).<span class="cm-variable">collect</span>()
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.5.0.0.0"></noscript><div class="results" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.5.0.0.4"><div class="ansiout">res46: Array[String] = Array(Matei Zaharia, Reynold Xin)
</div></div><noscript data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.5.0.0.5"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.5.0.0.6.2.0">0.27</span><span data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$1c50aff4-277e-4e5b-a9ae-628f91f0f19b.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-18 cell-3010286467588839-3010286467588859" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.4.0.0.0"><span class="cm-comment">// Run a filter</span>
<span class="cm-variable">ds</span>.<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">iq</span> <span class="cm-operator">&gt;</span> <span class="cm-number">140</span>).<span class="cm-variable">collect</span>()
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.5.0.0.0"></noscript><div class="results" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.5.0.0.4"><div class="ansiout">res47: Array[Person] = Array(Person(matei@databricks.com,180,Matei Zaharia))
</div></div><noscript data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.5.0.0.5"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.5.0.0.6.2.0">0.28</span><span data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$eb8c7b17-34cf-45d5-b404-7dc7f666a271.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-19 cell-3010286467588839-3010286467588860" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.4.0.0.0"><span class="cm-comment">// Can also run agregations to compute total IQ and average IQ grouped by some key</span>
<span class="cm-comment">// In this case we are just grouping by a constant 0, i.e. all records get grouped together</span>
<span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">apache</span>.<span class="cm-variable">spark</span>.<span class="cm-variable">sql</span>.<span class="cm-variable">expressions</span>.<span class="cm-variable">scala</span>.<span class="cm-variable">typed</span>
<span class="cm-variable">ds</span>.<span class="cm-variable">groupByKey</span>(<span class="cm-keyword">_</span> <span class="cm-operator">=&gt;</span> <span class="cm-number">0</span>).<span class="cm-variable">agg</span>(<span class="cm-variable">typed</span>.<span class="cm-variable">sum</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">iq</span>), <span class="cm-variable">typed</span>.<span class="cm-variable">avg</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">iq</span>)).<span class="cm-variable">collect</span>()
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.5.0.0.0"></noscript><div class="results" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.5.0.0.4"><div class="ansiout">import org.apache.spark.sql.expressions.scala.typed
res48: Array[(Int, Double, Double)] = Array((0,260.0,130.0))
</div></div><noscript data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.5.0.0.5"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.5.0.0.6.2.0">0.89</span><span data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$8b4fb3b4-5bd6-4954-9901-91c72cc84bdd.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-20 cell-3010286467588839-3010286467588861" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.4.0.0.0">%md
<span class="cm-header cm-header-3">### </span><span class="cm-header cm-header-3">Untyped</span><span class="cm-header cm-header-3"> </span><span class="cm-header cm-header-3">Dataset</span><span class="cm-header cm-header-3"> </span><span class="cm-header cm-header-3">API</span><span class="cm-header cm-header-3"> </span><span class="cm-header cm-header-3">(</span><span class="cm-header cm-header-3">a.k.a.</span><span class="cm-header cm-header-3"> </span><span class="cm-header cm-header-3">DataFrame</span><span class="cm-header cm-header-3"> </span><span class="cm-header cm-header-3">API)</span>

Dataset also includes untyped functions that return results in the form of DataFrames (i.e. Dataset<span class="cm-link">[</span><span class="cm-link">Row</span><span class="cm-link">]</span>). This API is available in all programming languages (Java/Scala/Python/R).
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.5.0.0"><div class="results dashboard" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.5.0.0.4"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="dbda6fa8-116b-4fc1-bc71-a4b175f68717"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>Untyped Dataset API (a.k.a. DataFrame API)</h3>
<p>Dataset also includes untyped functions that return results in the 
form of DataFrames (i.e. Dataset[Row]). This API is available in all 
programming languages (Java/Scala/Python/R).</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.5.0.0.6.2.0">0.00</span><span data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$687eb7cc-e393-4c0d-89c0-6256624ffe58.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-21 cell-3010286467588839-3010286467588862" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.4.0.0.0"><span class="cm-comment">// The select function is similar to the map function, but is not typed (i.e. it returns a DataFrame)</span>
<span class="cm-variable">ds</span>.<span class="cm-variable">select</span>(<span class="cm-string">"name"</span>).<span class="cm-variable">collect</span>()
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.5.0.0.0"></noscript><div class="results" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.5.0.0.4"><div class="ansiout">res49: Array[org.apache.spark.sql.Row] = Array([Matei Zaharia], [Reynold Xin])
</div></div><noscript data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.5.0.0.5"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.5.0.0.6.2.0">0.19</span><span data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$f6568f4d-9644-44a8-b4f1-0ec3b9a24bc9.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-22 cell-3010286467588839-3010286467588863" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.4.0.0.0"><span class="cm-comment">// Run some aggregations: note that we are using groupBy, which is different from the type safe groupByKey</span>
<span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">apache</span>.<span class="cm-variable">spark</span>.<span class="cm-variable">sql</span>.<span class="cm-variable">functions</span>.{<span class="cm-variable">sum</span>, <span class="cm-variable">avg</span>}
<span class="cm-variable">ds</span>.<span class="cm-variable">groupBy</span>().<span class="cm-variable">agg</span>(<span class="cm-variable">sum</span>(<span class="cm-string">"iq"</span>), <span class="cm-variable">avg</span>(<span class="cm-string">"iq"</span>)).<span class="cm-variable">collect</span>()
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.5.0.0.0"></noscript><div class="results" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.5.0.0.4"><div class="ansiout">import org.apache.spark.sql.functions.{sum, avg}
res50: Array[org.apache.spark.sql.Row] = Array([260,130.0])
</div></div><noscript data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.5.0.0.5"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.5.0.0.6.2.0">0.28</span><span data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$15c1ac54-fda8-4aad-933f-3714de34214f.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-23 cell-3010286467588839-3010286467588864" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.4.0.0.0">%md
<span class="cm-header cm-header-3">### </span><span class="cm-header cm-header-3">Interoperate</span><span class="cm-header cm-header-3"> </span><span class="cm-header cm-header-3">with</span><span class="cm-header cm-header-3"> </span><span class="cm-header cm-header-3">RDDs</span>

A Dataset can be easily turned into an RDD.
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.5.0.0"><div class="results dashboard" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.5.0.0.4"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="3b587f8e-841a-4ee6-baac-de2d79edb829"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>Interoperate with RDDs</h3>
<p>A Dataset can be easily turned into an RDD.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.5.0.0.6.2.0">0.00</span><span data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$e456d13f-ce72-44ff-94d3-1d76488aa5b7.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-24 cell-3010286467588839-3010286467588865" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.1.0"></i></a><div class="command-input previousPrompt" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.4"><div class="command-text command-text-finished" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.4.0.0.0"><span class="cm-variable">ds</span>.<span class="cm-variable">rdd</span>
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.5.0.0"><noscript data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.5.0.0.0"></noscript><div class="results" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.5.0.0.4"><div class="ansiout">res51: org.apache.spark.rdd.RDD[Person] = MapPartitionsRDD[679] at rdd at &lt;console&gt;:65
</div></div><noscript data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.5.0.0.5"></noscript><div class="command-result-stats hidden" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.5.0.0.6"><span data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.5.0.0.6.0">Command took</span><span data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.5.0.0.6.1"> </span><span data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.5.0.0.6.2"><span data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.5.0.0.6.2.0">0.12</span><span data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.5.0.0.6.2.1"> </span><span data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.5.0.0.6.2.2">seconds</span></span><span data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.5.0.0.6.3"> </span></div></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$af643d8d-cfd2-4df7-a638-f7884c22851f.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6-divider.1.0"></i></a></div><div class="new-notebook command mainCommand no-edit no-run command-finished cellIndex-25 cell-3010286467588839-3010286467588866" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6"><div class="command-comments-wrapper" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6.0"></div><a class="move-command-btn" draggable="true" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6.1"><i class="fa fa-sort" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6.1.0"></i></a><div class="command-input previousPrompt primaryPrompt" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6.4"><div class="command-text hidden command-text-finished" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6.4.0"><div class="command-box wrappable" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6.4.0.0"><pre class="cm-s-eclipse capture-run-mode" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6.4.0.0.0">%md
Again, to read the companion blog post, click here: https://databricks.com/blog/2016/05/11/spark-2-0-technical-preview-easier-faster-and-smarter.html
</pre></div></div></div><div class="results-and-comments" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6.5"><div class="command-result-wrapper" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6.5.0"><div class="command-result" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6.5.0.0"><div class="results dashboard" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6.5.0.0.4"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="e27541f8-36fa-4d5a-a9f0-79a4f107a8a7"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>Again, to read the companion blog post, click here: <a href="https://databricks.com/blog/2016/05/11/spark-2-0-technical-preview-easier-faster-and-smarter.html">https://databricks.com/blog/2016/05/11/spark-2-0-technical-preview-easier-faster-and-smarter.html</a></p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div><noscript data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6.5.0.0.6"></noscript></div></div><div style="clear:both;" data-reactid=".0.2.0.0.0.1:$d7f440cd-2bc3-4463-bb1f-cc56b0f8f7c6.5.1"></div></div></div><div class="command divider" data-reactid=".0.2.0.0.0.$last-command-divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" data-reactid=".0.2.0.0.0.$last-command-divider.0"><i class="fa fa-plus fa-fw" data-reactid=".0.2.0.0.0.$last-command-divider.0.0"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here" data-reactid=".0.2.0.0.0.$last-command-divider.1"><i class="fa fa-paste fa-fw" data-reactid=".0.2.0.0.0.$last-command-divider.1.0"></i></a></div><div class="contentSpacer" style="height:0px;" data-reactid=".0.2.0.0.0.4"></div></div></div></div></div></div></body></html>